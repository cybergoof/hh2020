



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Walk through of Holiday Hack 2020">
      
      
      
        <meta name="author" content="Shaun McCullough">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.3">
    
    
      
        <title>Tangle Coalbox in Speaker Room - Holiday Hack 2020</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../css/pdf.css">
    
      <link rel="stylesheet" href="../../css/html.css">
    
      <link rel="stylesheet" href="../../css/custom.css">
    
      <link rel="stylesheet" href="../../css/jquery.fancybox.min.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#speaker-room" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Holiday Hack 2020" aria-label="Holiday Hack 2020" class="md-header-nav__button md-logo">
          
            <i class="md-icon">home</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Holiday Hack 2020
            </span>
            <span class="md-header-nav__topic">
              
                Tangle Coalbox in Speaker Room
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Holiday Hack 2020" class="md-nav__button md-logo">
      
        <i class="md-icon">home</i>
      
    </a>
    Holiday Hack 2020
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Elves
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Elves
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../minstix/" title="Pepper Minstix in Castle Approach" class="md-nav__link">
      Pepper Minstix in Castle Approach
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../upatree/" title="Shiny Upatree in Castle Approach" class="md-nav__link">
      Shiny Upatree in Castle Approach
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mary/" title="Sugarplum Mary in courtyard" class="md-nav__link">
      Sugarplum Mary in courtyard
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bonbowford/" title="Ribb Bonbowford in Dining Room" class="md-nav__link">
      Ribb Bonbowford in Dining Room
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../shortstack/" title="Fitz ShortStack in Kitchen" class="md-nav__link">
      Fitz ShortStack in Kitchen
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../evergreen/" title="Holly Evergreen in Kitchen" class="md-nav__link">
      Holly Evergreen in Kitchen
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../bushy/" title="Bushy Evergreen in UNPre" class="md-nav__link">
      Bushy Evergreen in UNPre
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../candysalt/" title="Angel Candysalt in Great Room" class="md-nav__link">
      Angel Candysalt in Great Room
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../candycane/index.md" title="Minty Candycane in Workshop" class="md-nav__link">
      Minty Candycane in Workshop
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Tangle Coalbox in Speaker Room
      </label>
    
    <a href="./" title="Tangle Coalbox in Speaker Room" class="md-nav__link md-nav__link--active">
      Tangle Coalbox in Speaker Room
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tangle-coalbox-snowball-fight" class="md-nav__link">
    Tangle Coalbox  - Snowball Fight
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#on-easy" class="md-nav__link">
    On Easy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#impossible" class="md-nav__link">
    Impossible
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../openslae/" title="Wunorse Openslae in Netwars Room" class="md-nav__link">
      Wunorse Openslae in Netwars Room
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../snowball/" title="Alabaster Snowball in Netwars Room" class="md-nav__link">
      Alabaster Snowball in Netwars Room
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Objectives
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Objectives
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../objectives/obj1/" title="Objective 1 - Santa's List" class="md-nav__link">
      Objective 1 - Santa's List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../objectives/obj2/" title="Objective 2 - Investigate S3 Bucket" class="md-nav__link">
      Objective 2 - Investigate S3 Bucket
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../objectives/obj3/" title="Objective 3 - Point-of-Sale Password Recovery" class="md-nav__link">
      Objective 3 - Point-of-Sale Password Recovery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../objectives/obj4/" title="Objective 4 - Elevator" class="md-nav__link">
      Objective 4 - Elevator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../objectives/obj5/" title="Objective 5 - HID" class="md-nav__link">
      Objective 5 - HID
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../objectives/obj6/" title="Objective 6 - Splunk Challenge" class="md-nav__link">
      Objective 6 - Splunk Challenge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../objectives/obj7/" title="Objective 7 - CAN-Bus" class="md-nav__link">
      Objective 7 - CAN-Bus
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../objectives/obj8/" title="Objective 8 - Tag Generator" class="md-nav__link">
      Objective 8 - Tag Generator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../objectives/obj9/" title="Objective 9 - ARP Shenanigans" class="md-nav__link">
      Objective 9 - ARP Shenanigans
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../objectives/obj10/" title="Objective 10 - Bypass Fingerprint" class="md-nav__link">
      Objective 10 - Bypass Fingerprint
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../objectives/obj11a/" title="Objective 11.a - BlockChain" class="md-nav__link">
      Objective 11.a - BlockChain
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tangle-coalbox-snowball-fight" class="md-nav__link">
    Tangle Coalbox  - Snowball Fight
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#on-easy" class="md-nav__link">
    On Easy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#impossible" class="md-nav__link">
    Impossible
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="speaker-room">Speaker Room</h1>
<h2 id="tangle-coalbox-snowball-fight">Tangle Coalbox  - Snowball Fight</h2>
<p><img alt="Room" src="img/room.png" /></p>
<div class="admonition question">
<p class="admonition-title">Challenge</p>
<p>Howdy gumshoe. I'm Tangle Coalbox, resident sleuth in the North Pole.</p>
<p>If you're up for a challenge, I'd ask you to look at this here Snowball Game.</p>
<p>We tested an earlier version this summer, but that one had web socket vulnerabilities.</p>
<p>This version seems simple enough on the Easy level, but the Impossible level is, well...</p>
<p>I'd call it impossible, but I just saw someone beat it! I'm sure something's off here.</p>
<p>Could it be that the name a player provides has some connection to how the forts are laid out?</p>
<p>Knowing that, I can see how an elf might feed their Hard name into an Easy game to cheat a bit.</p>
<p>But on Impossible, the best you get are rejected player names in the page comments. Can you use those somehow?</p>
<p>Check out Tom Liston's talk for more info, if you need it.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
</div>
<p>Tom Liston's talk on <a href="https://www.youtube.com/watch?v=Jo5Nlbqd-Vg">mersenne twisters</a></p>
<p>Tom has code to help with cloning at <a href="https://github.com/tliston/mt19937">Github</a></p>
<h2 id="on-easy">On Easy</h2>
<p>I just started randomly hitting the board until I won.</p>
<h2 id="impossible">Impossible</h2>
<p>I started the game and took a look in the comments. there were a list of random numbers to seed the code.  I copied them to a <code>seeds.txt</code> file.  This file had a list of random numbers that were discarded, the next one would be the one in use to generate the board.  Therefore, we had to figure out what the next random number would be.</p>
<p>Taking Tom's code and reworking the main(), I was able to detect the next random code, which is what was used to generate the game board.</p>
<div class="codehilite"><pre><span></span><code><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">myprng</span> <span class="o">=</span> <span class="n">mt19937</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">seed_array</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;seeds.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">my_file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="n">my_file</span><span class="p">:</span>
            <span class="n">seed_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">seed</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mt19937</span><span class="o">.</span><span class="n">n</span><span class="p">):</span>
        <span class="n">myprng</span><span class="o">.</span><span class="n">MT</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">untemper</span><span class="p">(</span><span class="n">seed_array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The next numbers is </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">myprng</span><span class="o">.</span><span class="n">extract_number</span><span class="p">())</span>
</code></pre></div>
<p>I opened another version of the game, on easy and using the predicted next key, tested every square until I knew what the board was.  I then went back to the original Impossible game and finished it.</p>
<div class="admonition tip">
<p class="admonition-title">Tangle Coalbox</p>
<p>Crikey - that's it! You've done the Impossible! You've impressed this old elf today.</p>
<p>Great work identifying and abusing the pseudo-random sequence.</p>
<p>Now, the REAL question is, how else can this be abused? Do you think someone could try and cheat the Naughty/Nice Blockchain with this?</p>
<p>If you have control over to bytes in a file, it's easy to create MD5 hash collisions.</p>
<p>Problem is: there's that nonce that he would have to know ahead of time.</p>
<p>A blockchain works by "chaining" blocks together - so there's no way that Jack could change it without it messing up the chain...</p>
<p>Maybe if you look at the block that seems like it got changed, it might help.</p>
<p>If Jack was able to change the block AND the document without changing the hash... that would require a very UNIque hash COLLision.</p>
<p>Apparently Jack was able to change just 4 bytes in the block to completely change everything about it. It's like some sort of evil game to him.</p>
<p>That's about all the help I can give you, kid, but Prof. Petabyte may have more.</p>
</div>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../candysalt/" title="Angel Candysalt in Great Room" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Angel Candysalt in Great Room
              </span>
            </div>
          </a>
        
        
          <a href="../openslae/" title="Wunorse Openslae in Netwars Room" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Wunorse Openslae in Netwars Room
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Â©2021 Shaun McCullough
          </div>
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../js/jquery-3.4.1.min.js"></script>
      
        <script src="../../js/jquery.fancybox.min.js"></script>
      
        <script src="../../js/workbook.js"></script>
      
        <script src="../../js/custom.js"></script>
      
    
  </body>
</html>