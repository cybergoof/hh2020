



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Walk through of Holiday Hack 2020">
      
      
      
        <meta name="author" content="Shaun McCullough">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.3">
    
    
      
        <title>Objective 11.a - BlockChain - Holiday Hack 2020</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../css/pdf.css">
    
      <link rel="stylesheet" href="../../css/html.css">
    
      <link rel="stylesheet" href="../../css/custom.css">
    
      <link rel="stylesheet" href="../../css/jquery.fancybox.min.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#santas-office" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Holiday Hack 2020" aria-label="Holiday Hack 2020" class="md-header-nav__button md-logo">
          
            <i class="md-icon">home</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Holiday Hack 2020
            </span>
            <span class="md-header-nav__topic">
              
                Objective 11.a - BlockChain
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Holiday Hack 2020" class="md-nav__button md-logo">
      
        <i class="md-icon">home</i>
      
    </a>
    Holiday Hack 2020
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Elves
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Elves
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../elves/minstix/" title="Pepper Minstix in Castle Approach" class="md-nav__link">
      Pepper Minstix in Castle Approach
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../elves/upatree/" title="Shiny Upatree in Castle Approach" class="md-nav__link">
      Shiny Upatree in Castle Approach
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../elves/mary/" title="Sugarplum Mary in courtyard" class="md-nav__link">
      Sugarplum Mary in courtyard
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../elves/bonbowford/" title="Ribb Bonbowford in Dining Room" class="md-nav__link">
      Ribb Bonbowford in Dining Room
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../elves/shortstack/" title="Fitz ShortStack in Kitchen" class="md-nav__link">
      Fitz ShortStack in Kitchen
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../elves/evergreen/" title="Holly Evergreen in Kitchen" class="md-nav__link">
      Holly Evergreen in Kitchen
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../elves/bushy/" title="Bushy Evergreen in UNPre" class="md-nav__link">
      Bushy Evergreen in UNPre
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../elves/candysalt/" title="Angel Candysalt in Great Room" class="md-nav__link">
      Angel Candysalt in Great Room
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../elves/candycane/index.md" title="Minty Candycane in Workshop" class="md-nav__link">
      Minty Candycane in Workshop
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../elves/coalbox/" title="Tangle Coalbox in Speaker Room" class="md-nav__link">
      Tangle Coalbox in Speaker Room
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../elves/openslae/" title="Wunorse Openslae in Netwars Room" class="md-nav__link">
      Wunorse Openslae in Netwars Room
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../elves/snowball/" title="Alabaster Snowball in Netwars Room" class="md-nav__link">
      Alabaster Snowball in Netwars Room
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Objectives
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Objectives
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../obj1/" title="Objective 1 - Santa's List" class="md-nav__link">
      Objective 1 - Santa's List
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../obj2/" title="Objective 2 - Investigate S3 Bucket" class="md-nav__link">
      Objective 2 - Investigate S3 Bucket
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../obj3/" title="Objective 3 - Point-of-Sale Password Recovery" class="md-nav__link">
      Objective 3 - Point-of-Sale Password Recovery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../obj4/" title="Objective 4 - Elevator" class="md-nav__link">
      Objective 4 - Elevator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../obj5/" title="Objective 5 - HID" class="md-nav__link">
      Objective 5 - HID
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../obj6/" title="Objective 6 - Splunk Challenge" class="md-nav__link">
      Objective 6 - Splunk Challenge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../obj7/" title="Objective 7 - CAN-Bus" class="md-nav__link">
      Objective 7 - CAN-Bus
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../obj8/" title="Objective 8 - Tag Generator" class="md-nav__link">
      Objective 8 - Tag Generator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../obj9/" title="Objective 9 - ARP Shenanigans" class="md-nav__link">
      Objective 9 - ARP Shenanigans
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../obj10/" title="Objective 10 - Bypass Fingerprint" class="md-nav__link">
      Objective 10 - Bypass Fingerprint
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Objective 11.a - BlockChain
      </label>
    
    <a href="./" title="Objective 11.a - BlockChain" class="md-nav__link md-nav__link--active">
      Objective 11.a - BlockChain
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tinsel-upatree-naughty-and-nice-list" class="md-nav__link">
    Tinsel Upatree - Naughty and Nice List
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tinsel-upatree-naughty-and-nice-list" class="md-nav__link">
    Tinsel Upatree - Naughty and Nice List
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="santas-office">Santa's Office</h1>
<h2 id="tinsel-upatree-naughty-and-nice-list">Tinsel Upatree - Naughty and Nice List</h2>
<p><img alt="Room" src="img/room.png" /></p>
<p><img alt="challenge" src="img/challenge.png" /></p>
<div class="admonition question">
<p class="admonition-title">Challenge</p>
<p>Howdy Santa! Just guarding the Naughty/Nice list on your desk.</p>
<p>Santa, I don't know if you've heard, but something is very, very wrong...</p>
<p>We tabulated the latest score of the Naughty/Nice Blockchain.</p>
<p>Jack Frost is the nicest being in the world! Jack Frost!?!</p>
<p>As you know, we only really start checking the Naughty/Nice totals as we get closer to the holidays.</p>
<p>Out of nowhere, Jack Frost has this crazy score... positive 4,294,935,958 nice points!</p>
<p>No one has EVER gotten a score that high! No one knows how it happened.</p>
<p>Most of us recall Jack having a NEGATIVE score only a few days ago...</p>
<p>Worse still, his huge positive score seems to have happened way back in March.</p>
<p>Our first thought was that he somehow changed the blockchain - but, as you know, that isn't possible.</p>
<p>We ran a validation of the blockchain and it all checks out.</p>
<p>Even the smallest change to any block should make it invalid.</p>
<p>Blockchains are huge, so we cut a one minute chunk from when Jack's big score registered back in March.</p>
<p>You can get a slice of the Naughty/Nice blockchain on your desk.</p>
<p>You can get some tools to help you here.</p>
<p>Tangle Coalbox, in the Speaker UNPreparedness room. has been talking with attendees about the issue.</p>
</div>
<h1 id="tools">Tools</h1>
<p>The code for this challenge can be found in the <a href="https://download.holidayhackchallenge.com/2020/OfficialNaughtyNiceBlockchainEducationPack.zip">Official Naughty Nice Blockhain Education Pack</a>. </p>
<p>The Blockchain to be loaded is provided in the file <a href="https://download.holidayhackchallenge.com/2020/blockchain.dat">Blockchain.dat</a></p>
<div class="admonition hint">
<p class="admonition-title">Hint Part A</p>
<p>If you have control over to bytes in a file, it's easy to create MD5 <a href="https://github.com/corkami/collisions">hash collisions</a>. Problem is: there's that nonce that he would have to know ahead of time.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tangle Hints</p>
<p>Crikey - that's it! You've done the Impossible! You've impressed this old elf today.</p>
<p>Great work identifying and abusing the pseudo-random sequence.</p>
<p>Now, the REAL question is, how else can this be abused? Do you think someone could try and cheat the Naughty/Nice Blockchain with this?</p>
<p>If you have control over to bytes in a file, it's easy to create <a href="https://github.com/corkami/collisions">MD5 hash collisions</a>.</p>
<p>Problem is: there's that nonce that he would have to know ahead of time.</p>
<p>A blockchain works by "chaining" blocks together - so there's no way that Jack could change it without it messing up the chain...</p>
<p>Maybe if you look at the block that seems like it got changed, it might help.</p>
<p>If Jack was able to change the block AND the document without changing the hash... that would require a very <a href="https://github.com/cr-marcstevens/hashclash">UNIque hash COLLision</a>.</p>
<p>Apparently Jack was able to change just 4 bytes in the block to completely change everything about it. It's like some sort of <a href="https://speakerdeck.com/ange/colltris">evil game</a> to him.</p>
<p>That's about all the help I can give you, kid, but Prof. Petabyte may have <a href="https://www.youtube.com/watch?v=7rLMl88p-ec">more</a>.</p>
</div>
<h2 id="how-i-did-this">How I did this</h2>
<p><a href="naughty_nice.py">Link to the full code</a>
There are simliarities between this code and the Snowball Game.  One big difference is that the nonces, which have to be predicted, are 64bit rather than 32bit.  Each nonce has to be split into two 32 bit nonce-parts.  The <code>mt19937</code> class can predict the nonces by creating the seed array by appending the lower 32, then the higher 32.  </p>
<p>I wrote python code that would perform the following:</p>
<ol>
<li>
<p>Extracted the bitcoin.dat file and build the Python objects as provided in the <code>OfficalNaughtNiceBlockchainEducationPack</code>
<div class="codehilite"><pre><span></span><code>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;official_public.pem&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
        <span class="n">official_public_key</span> <span class="o">=</span> <span class="n">RSA</span><span class="o">.</span><span class="n">importKey</span><span class="p">(</span><span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">c2</span> <span class="o">=</span> <span class="n">Chain</span><span class="p">(</span><span class="n">load</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;blockchain.dat&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;C2: Block chain verify: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">verify_chain</span><span class="p">(</span><span class="n">official_public_key</span><span class="p">)))</span>
</code></pre></div></p>
</li>
<li>
<p>Extract the nonce, split into lower and higher 32 bits, and save to a seed array.</p>
</li>
</ol>
<div class="codehilite"><pre><span></span><code>    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">c2</span><span class="o">.</span><span class="n">blocks</span><span class="p">:</span>
        <span class="c1"># Convert the seed.</span>
        <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">getNonces</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">nonce</span><span class="p">,</span> <span class="s1">&#39;016X&#39;</span><span class="p">))</span>

        <span class="n">seed_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span>
        <span class="n">seed_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>
        <span class="n">test_nonce</span> <span class="o">=</span> <span class="n">combine</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>
        <span class="n">real_nonce</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">nonce</span><span class="p">,</span> <span class="s1">&#39;016X&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">real_nonce</span> <span class="o">!=</span> <span class="n">test_nonce</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[ERROR] Block is bad for </span><span class="si">{}</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
        <span class="n">nonce_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">nonce</span><span class="p">,</span> <span class="s1">&#39;016X&#39;</span><span class="p">))</span>
</code></pre></div>
<ul>
<li>
<p>Run the known Nonces through the code used to predict in the <a href="../../labs/coalbox">Snowball game challenge</a>
<div class="codehilite"><pre><span></span><code>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mt19937</span><span class="o">.</span><span class="n">n</span><span class="p">):</span>
        <span class="n">myprng</span><span class="o">.</span><span class="n">MT</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">untemper</span><span class="p">(</span><span class="n">seed_array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</code></pre></div></p>
</li>
<li>
<p>Loop through all the known nonces in the blockchain and compare to the next predicted value.  If there is a missed value, then we know there is a problem with the code.  I had alot of problems getting the nonce split and recombine to work properly, so this was good to test.</p>
</li>
</ul>
<div class="codehilite"><pre><span></span><code>   <span class="n">predicted_numbers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">block_chain_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">c2</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mt19937</span><span class="o">.</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">):]:</span>
        <span class="n">lower_predict</span> <span class="o">=</span> <span class="n">myprng</span><span class="o">.</span><span class="n">extract_number</span><span class="p">()</span>
        <span class="n">upper_predict</span> <span class="o">=</span> <span class="n">myprng</span><span class="o">.</span><span class="n">extract_number</span><span class="p">()</span>
        <span class="n">new_num</span> <span class="o">=</span> <span class="n">combine</span><span class="p">(</span><span class="n">lower_predict</span><span class="p">,</span> <span class="n">upper_predict</span><span class="p">)</span>
        <span class="n">hex_is</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">nonce</span><span class="p">,</span> <span class="s1">&#39;016X&#39;</span><span class="p">)</span>
        <span class="n">found</span> <span class="o">=</span> <span class="nb">next</span><span class="p">((</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">nonce_array</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">new_num</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">found</span><span class="o">==</span><span class="kc">None</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not found&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">combine</span><span class="p">(</span><span class="n">lower_predict</span><span class="p">,</span> <span class="n">upper_predict</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">format</span><span class="p">(</span><span class="n">block</span><span class="o">.</span><span class="n">nonce</span><span class="p">,</span> <span class="s1">&#39;016X&#39;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Something wrong: block.nonce %&quot;</span><span class="p">)</span>
</code></pre></div>
<ul>
<li>Now, loop through to predict from the last know block index, to what would be block index 13000.
<div class="codehilite"><pre><span></span><code>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">blocks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">130001</span><span class="p">):</span>
        <span class="n">low_predict</span> <span class="o">=</span> <span class="n">myprng</span><span class="o">.</span><span class="n">extract_number</span><span class="p">()</span>
        <span class="n">high_predict</span> <span class="o">=</span> <span class="n">myprng</span><span class="o">.</span><span class="n">extract_number</span><span class="p">()</span>
        <span class="n">combined_value</span> <span class="o">=</span> <span class="n">combine</span><span class="p">(</span><span class="n">low_predict</span><span class="p">,</span> <span class="n">high_predict</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Index </span><span class="si">{}</span><span class="s2"> nonce is </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">combined_value</span><span class="p">))</span>
</code></pre></div></li>
</ul>
<div class="admonition success">
<p class="admonition-title">Success</p>
<p><code>57066318F32F729D</code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>I did not complete Object 11b, although I was able to extract the block in question and extract the binary and PDF file.
<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">block</span> <span class="ow">in</span> <span class="n">c2</span><span class="o">.</span><span class="n">blocks</span><span class="p">:</span>
    <span class="n">sha256_value</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">full_hash_265</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">sha256_value</span> <span class="o">==</span> <span class="s2">&quot;58a3b9335a6ceb0234c12d35a0564c4ef0e90152d0eb2ce2082383b38028a90f&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
        <span class="n">block</span><span class="o">.</span><span class="n">dump_doc</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">block</span><span class="o">.</span><span class="n">dump_doc</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></p>
</div>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../obj10/" title="Objective 10 - Bypass Fingerprint" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Objective 10 - Bypass Fingerprint
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            ©2021 Shaun McCullough
          </div>
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../js/jquery-3.4.1.min.js"></script>
      
        <script src="../../js/jquery.fancybox.min.js"></script>
      
        <script src="../../js/workbook.js"></script>
      
        <script src="../../js/custom.js"></script>
      
    
  </body>
</html>